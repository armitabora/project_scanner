<!DOCTYPE html>
<html lang="en">
<head>
    <title>Scan Progress</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h2>üîç Scanning {{ url }}</h2>
        <div class="progress mt-3">
            <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" 
                 style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
        </div>
        
        <div id="loadingSpinner" class="spinner-border text-light mt-3" role="status">
            <span class="visually-hidden">Scanning...</span>
        </div>
        
        <p id="status">Initializing scan...</p>
    </div>

    <script>
    
        function updateProgress() {
            fetch('/progress')
                .then(response => response.json())
                .then(data => {
                    const progressBar = document.getElementById('progressBar');
                    const status = document.getElementById('status');
                    progressBar.style.width = data.progress + '%';
                    progressBar.innerText = data.progress + '%';
                    status.innerText = data.progress < 100 ? "Scanning..." : "Scan complete! Redirecting...";

                    if (data.progress >= 100) {
                        window.location.href = '/results';
                    } else {
                        setTimeout(updateProgress, 1000);  // Update every second
                    }
                });
        }
       
        // Start updating progress
        updateProgress();
    </script>
</body>
</html>